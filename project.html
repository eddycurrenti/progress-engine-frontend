<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Project Tracker</title>

<link rel="preconnect" href="https://fonts.googleapis.com">
<link href="https://fonts.googleapis.com/css2?family=Sirin+Stencil&display=swap" rel="stylesheet">

<style>
*{
    margin:0;
    padding:0;
    box-sizing:border-box;
    font-family:"Sirin Stencil",sans-serif;
}

body{
    background:#0f172a;
    color:white;
    min-height:100vh;
}

/* Background Glow */
body::before{
    content:"";
    position:fixed;
    width:200%;
    height:200%;
    top:-50%;
    left:-50%;
    background:radial-gradient(#2563eb 1px, transparent 1px);
    background-size:40px 40px;
    opacity:0.15;
    animation:move 60s linear infinite;
    z-index:-1;
}
@keyframes move{
    from{transform:translate(0,0);}
    to{transform:translate(400px,400px);}
}

/* Layout */
.container{
    max-width:1200px;
    margin:auto;
    padding:60px 20px;
}

h1{
    text-align:center;
    margin-bottom:50px;
}

/* Section */
.section{
    background:rgba(30,41,59,0.9);
    backdrop-filter:blur(10px);
    padding:30px;
    border-radius:18px;
    box-shadow:0 15px 35px rgba(0,0,0,0.4);
    margin-bottom:40px;
}

/* Buttons */
.btn{
    padding:12px 18px;
    border:none;
    border-radius:12px;
    background:#000;
    color:white;
    cursor:pointer;
    position:relative;
    transition:0.3s ease;
}

.btn:hover{
    transform:translateY(-2px);
}

/* Project Card */
.project-card{
    background:linear-gradient(
        145deg,
        rgba(51,65,85,0.95),
        rgba(30,41,59,0.95)
    );
    padding:22px;
    border-radius:18px;
    margin-top:20px;
    border:1px solid rgba(255,255,255,0.06);
    box-shadow:
        0 15px 40px rgba(0,0,0,0.4),
        inset 0 1px 0 rgba(255,255,255,0.04);
    transition:all .3s ease;
}


.project-card:hover{
    transform:translateY(-6px);
    box-shadow:
        0 25px 60px rgba(0,0,0,0.6);
}

.badge-progress{
    background:#2563eb;
    box-shadow:0 0 15px rgba(37,99,235,0.5);
}

.badge-complete{
    background:#22c55e;
    box-shadow:0 0 15px rgba(34,197,94,0.5);
}

.badge-paused{
    background:#f59e0b;
    box-shadow:0 0 15px rgba(245,158,11,0.5);
}

.project-header{
    display:flex;
    justify-content:space-between;
    align-items:center;
    cursor:pointer;
}

.project-title{
    font-size:16px;
    font-weight:600;
}

.project-badge{
    padding:5px 12px;
    border-radius:999px;
    font-size:12px;
}

.badge-progress{ background:#2563eb; }
.badge-complete{ background:#22c55e; }
.badge-paused{ background:#f59e0b; }
.badge-not{ background:#64748b; }

.project-body{
    display:none;
    margin-top:12px;
    font-size:14px;
    line-height:1.6;
}

.project-links a{
    color:#60a5fa;
    text-decoration:none;
    margin-right:12px;
}

.project-links a:hover{
    text-decoration:underline;
}

/* Modal */
/* Disable body scroll */
body.modal-open{
    overflow:hidden;
}

/* Overlay */
.modal{
    position:fixed;
    inset:0;
    display:none;
    align-items:center;
    justify-content:center;
    background:rgba(5,12,31,0.65);
    backdrop-filter:blur(18px);
    z-index:1000;
    animation:fadeOverlay 0.3s ease;
}

/* Glass Modal Card */
.modal-content{
    width:650px;
    max-height:85vh;
    overflow-y:auto;
    padding:40px;
    border-radius:28px;
    background:linear-gradient(
        145deg,
        rgba(30,41,59,0.85),
        rgba(15,23,42,0.85)
    );
    border:1px solid rgba(255,255,255,0.08);
    box-shadow:
        0 0 60px rgba(0,0,0,0.6),
        0 0 40px rgba(59,130,246,0.15);
    animation:scaleIn 0.35s cubic-bezier(.17,.67,.37,1.35);
}

/* Close Button */
.modal-close{
    position:absolute;
    top:25px;
    right:30px;
    width:42px;
    height:42px;
    border-radius:12px;
    background:linear-gradient(135deg,#ef4444,#dc2626);
    display:flex;
    align-items:center;
    justify-content:center;
    font-weight:bold;
    cursor:pointer;
    transition:0.25s ease;
}

.modal-close:hover{
    transform:scale(1.08);
    box-shadow:0 0 20px rgba(239,68,68,0.5);
}

/* Scrollbar for modal */
.modal-content::-webkit-scrollbar {
    width: 6px;
}

.modal-content::-webkit-scrollbar-track {
    background: transparent;
}

.modal-content::-webkit-scrollbar-thumb {
    background: rgba(148,163,184,0.35);
    border-radius: 20px;
    transition: background 0.3s ease;
}

.modal-content::-webkit-scrollbar-thumb:hover {
    background: rgba(148,163,184,0.6);
}

/* Animations */
@keyframes scaleIn{
    from{transform:scale(0.92);opacity:0;}
    to{transform:scale(1);opacity:1;}
}

@keyframes fadeOverlay{
    from{opacity:0;}
    to{opacity:1;}
}
.project-stats{
    display:flex;
    gap:30px;
    margin:20px 0;
    font-size:14px;
    color:#94a3b8;
}

.tech-stack{
    display:flex;
    flex-wrap:wrap;
    gap:8px;
    margin:8px 0 12px 0;
}

.tech-tag{
    background:rgba(59,130,246,0.15);
    border:1px solid rgba(59,130,246,0.3);
    color:#60a5fa;
    padding:5px 10px;
    font-size:12px;
    border-radius:999px;
}

input,select{
    width:100%;
    padding:12px;
    margin-bottom:15px;
    border:none;
    border-radius:10px;
    background:#334155;
    color:white;
}

.footer{
    text-align:center;
    padding:30px;
    border-top:1px solid rgba(255,255,255,0.1);
    color:#94a3b8;
}
</style>
</head>

<body>

<div class="container">

<h1>My Project Tracker</h1>

<div class="section">
    <button class="btn" onclick="goTOhome()">Home</button>
    <button class="btn" onclick="openProjectModal()">Add Project</button>
    <button class="btn" onclick="loadProjects()">Refresh</button>
    <div class="project-stats">
    <div>Total: <span id="totalProjects">0</span></div>
    <div>Completed: <span id="completedProjects">0</span></div>
    <div>In Progress: <span id="progressProjects">0</span></div>
</div>

    <div id="projectList"></div>
</div>

</div>

<!-- Modal -->
<div id="projectModal" class="modal">
    <div class="modal-content">

        <div class="modal-close" onclick="closeProjectModal()">X</div>
        <div class="modal-title" id="modalTitle">Add Project</div>

        <input type="text" id="pName" placeholder="Project Name">
        <input type="text" id="pDescription" placeholder="Description">
        <input type="text" id="pStack" placeholder="Tech Stack (comma separated)">
        <input type="date" id="pStart">
        <input type="date" id="pCompleted">

        <select id="pStatus">
            <option value="">Status</option>
            <option>Not Started</option>
            <option>In Progress</option>
            <option>Completed</option>
            <option>Paused</option>
        </select>

        <select id="pDeploy">
            <option value="">Deployment</option>
            <option value="true">Deployed</option>
            <option value="false">Not Deployed</option>
        </select>

        <input type="text" id="pLive" placeholder="Live URL">
        <input type="text" id="pGithubF" placeholder="GitHub Frontend">
        <input type="text" id="pGithubB" placeholder="GitHub Backend">

        <button class="btn full-btn" onclick="addProject()">Save</button>

    </div>
</div>


<div class="footer">
    <div><strong>Patil Tejas Ashok</strong></div>
    <div>reso49@gmail.com</div>
</div>

<script>
const BASE="http://localhost:3000";
let currentEditId = null;
if(!localStorage.getItem("token")){
    window.location.href="/login.html";
}

async function authFetch(url,options={}){
    options.headers={
        ...(options.headers||{}),
        "Authorization":"Bearer "+localStorage.getItem("token")
    };
    return fetch(url,options);
}

function openProjectModal(){
    document.getElementById("projectModal").style.display="flex";
    document.body.classList.add("modal-open");
}

function closeProjectModal(){
    document.getElementById("projectModal").style.display="none";
    document.body.classList.remove("modal-open");
}

window.addEventListener("click",function(e){
    const modal=document.getElementById("projectModal");
    if(e.target===modal) closeProjectModal();
});

window.addEventListener("keydown",function(e){
    if(e.key==="Escape") closeProjectModal();
});


async function loadProjects(){

    const res = await authFetch(`${BASE}/project/getProjects`);
    if(!res.ok) return;

    const data = await res.json();
    const container = document.getElementById("projectList");

    container.innerHTML = "";

    let total = 0;
    let completed = 0;
    let progress = 0;

    data.forEach(p => {

        total++;
        if(p.status === "Completed") completed++;
        if(p.status === "In Progress") progress++;

        let badge="badge-not";
        if(p.status==="In Progress") badge="badge-progress";
        if(p.status==="Completed") badge="badge-complete";
        if(p.status==="Paused") badge="badge-paused";

        const stackTags = p.techStack.map(
            s => `<span class="tech-tag">${s}</span>`
        ).join("");

        const div=document.createElement("div");
        div.className="project-card";

        div.innerHTML=`
            <div class="project-header" onclick="toggleProject(this)">
                <div class="project-title">${p.name}</div>
                <div class="project-badge ${badge}">${p.status}</div>
            </div>

            <div class="project-body">
                <div><strong>Description:</strong> ${p.description}</div>

                <div><strong>Stack:</strong></div>
                <div class="tech-stack">${stackTags}</div>

                <div><strong>Start:</strong> ${new Date(p.startDate).toLocaleDateString()}</div>

                ${p.completedDate ?
                    `<div><strong>Completed:</strong> ${new Date(p.completedDate).toLocaleDateString()}</div>`
                    : ""
                }

                <div><strong>Deployment:</strong> ${p.deploymentStatus?"Deployed":"Not Deployed"}</div>

                <div class="project-links">
                    ${p.liveURL?`<a href="${p.liveURL}" target="_blank">Live</a>`:""}
                    ${p.githubFront?`<a href="${p.githubFront}" target="_blank">Frontend</a>`:""}
                    ${p.githubBackend?`<a href="${p.githubBackend}" target="_blank">Backend</a>`:""}
                </div>

                <div style="margin-top:12px;">
                    <button class="btn" onclick="openEditModal('${p._id}')">Edit</button>
                </div>
            </div>
        `;

        container.appendChild(div);
    });

    document.getElementById("totalProjects").innerText = total;
    document.getElementById("completedProjects").innerText = completed;
    document.getElementById("progressProjects").innerText = progress;
}

async function openEditModal(id){

    const res = await authFetch(`${BASE}/project/getProjects`);
    const projects = await res.json();

    const project = projects.find(p => p._id === id);
    if(!project) return;

    currentEditId = id;

    document.getElementById("pName").value = project.name;
    document.getElementById("pDescription").value = project.description;
    document.getElementById("pStack").value = project.techStack.join(", ");
    document.getElementById("pStart").value = project.startDate.split("T")[0];
    document.getElementById("pCompleted").value =
        project.completedDate ? project.completedDate.split("T")[0] : "";

    document.getElementById("pStatus").value = project.status;
    document.getElementById("pDeploy").value = project.deploymentStatus ? "true" : "false";
    document.getElementById("pLive").value = project.liveURL || "";
    document.getElementById("pGithubF").value = project.githubFront || "";
    document.getElementById("pGithubB").value = project.githubBackend || "";

    openProjectModal();
}

function goTOhome(){
    window.location.href = "/index.html";
}
function toggleProject(el){
    const body=el.nextElementSibling;
    body.style.display=body.style.display==="block"?"none":"block";
}

async function addProject(){

    const body={
        name:document.getElementById("pName").value,
        description:document.getElementById("pDescription").value,
        techStack:document.getElementById("pStack").value.split(",").map(s=>s.trim()),
        startDate:document.getElementById("pStart").value,
        completedDate:document.getElementById("pCompleted").value,
        status:document.getElementById("pStatus").value,
        deploymentStatus:document.getElementById("pDeploy").value==="true",
        liveURL:document.getElementById("pLive").value,
        githubFront:document.getElementById("pGithubF").value,
        githubBackend:document.getElementById("pGithubB").value
    };

    if(currentEditId){
        await authFetch(`${BASE}/project/update/${currentEditId}`,{
            method:"PATCH",
            headers:{"Content-Type":"application/json"},
            body:JSON.stringify(body)
        });
        currentEditId = null;
    } else {
        await authFetch(`${BASE}/project/addnew`,{
            method:"POST",
            headers:{"Content-Type":"application/json"},
            body:JSON.stringify(body)
        });
    }

    closeProjectModal();
    loadProjects();
}

window.onload=loadProjects;
</script>

</body>
</html>
